


<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>My Account â€” Natishlux</title>
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Jost:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#fff;
      --text:#111;
      --muted:#666;
      --accent:#000;
      --gold:#e0245e;
      --container:1200px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:"Jost",system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
      color:var(--text);
      background:var(--bg);
      line-height:1.45;
    }
    a{color:inherit;text-decoration:none}

    .container{max-width:var(--container);margin:0 auto;padding:0 20px}
    
    header{
      border-bottom:1px solid #eee;
      background:#fff;
      position:sticky;top:0;z-index:50;
    }
    .nav{
      display:flex;align-items:center;justify-content:space-between;padding:18px 0;
    }
    .logo{font-weight:700;letter-spacing:.3px;font-size:20px}
    .nav-links{display:flex;gap:18px;align-items:center}
    .btn{background:var(--accent);color:#fff;padding:10px 16px;border-radius:8px;font-weight:600;border:none;cursor:pointer;transition:transform .2s}
    .btn:hover{transform:translateY(-2px)}
    .btn-secondary{background:#f5f5f5;color:var(--accent)}

    .page-header{
      text-align:center;
      padding:48px 0 32px;
      background:linear-gradient(180deg, #fafafa, #fff);
    }
    .page-header h1{
      font-size:clamp(32px,5vw,44px);
      margin:0 0 8px;
      color:var(--gold);
      font-weight:700;
    }

    .account-container{
      max-width:1200px;
      margin:0 auto;
      padding:40px 20px 80px;
      display:grid;
      grid-template-columns:280px 1fr;
      gap:40px;
    }

    .account-sidebar{
      background:#fafafa;
      border-radius:12px;
      padding:24px;
      height:fit-content;
      position:sticky;
      top:90px;
    }
    .account-sidebar h3{
      margin:0 0 20px;
      font-size:18px;
      color:var(--accent);
    }
    .account-nav{
      list-style:none;
      padding:0;
      margin:0;
    }
    .account-nav li{
      margin-bottom:8px;
    }
    .account-nav a{
      display:block;
      padding:12px 16px;
      border-radius:8px;
      color:var(--muted);
      transition:background .2s,color .2s;
    }
    .account-nav a:hover,
    .account-nav a.active{
      background:#fff;
      color:var(--gold);
      font-weight:600;
    }

    .account-content{
      background:#fff;
    }
    .section{
      margin-bottom:32px;
      padding:24px;
      border:1px solid #e0e0e0;
      border-radius:12px;
    }
    .section h2{
      font-size:24px;
      margin:0 0 20px;
      color:var(--accent);
      font-weight:700;
    }

    .info-grid{
      display:grid;
      grid-template-columns:repeat(2,1fr);
      gap:16px;
    }
    .info-item{
      padding:16px;
      background:#fafafa;
      border-radius:8px;
    }
    .info-label{
      font-size:13px;
      color:var(--muted);
      margin-bottom:4px;
    }
    .info-value{
      font-weight:600;
      color:var(--accent);
    }

    .order-card{
      padding:20px;
      border:1px solid #e0e0e0;
      border-radius:12px;
      margin-bottom:16px;
      transition:box-shadow .2s;
    }
    .order-card:hover{
      box-shadow:0 4px 12px rgba(0,0,0,0.08);
    }
    .order-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:16px;
      padding-bottom:16px;
      border-bottom:1px solid #e0e0e0;
    }
    .order-number{
      font-weight:700;
      color:var(--accent);
    }
    .order-date{
      color:var(--muted);
      font-size:14px;
    }
    .order-status{
      padding:6px 12px;
      border-radius:6px;
      font-size:13px;
      font-weight:600;
      text-transform:capitalize;
    }
    .status-pending{background:#fff3cd;color:#856404}
    .status-processing{background:#d1ecf1;color:#0c5460}
    .status-shipped{background:#d4edda;color:#155724}
    .status-delivered{background:#d4edda;color:#155724}
    .status-cancelled{background:#f8d7da;color:#721c24}

    .order-items{
      margin:16px 0;
    }
    .order-item{
      display:flex;
      gap:12px;
      padding:12px 0;
    }
    .order-item-img{
      width:60px;
      height:60px;
      border-radius:6px;
      overflow:hidden;
    }
    .order-item-img img{
      width:100%;
      height:100%;
      object-fit:cover;
    }
    .order-item-name{
      font-weight:600;
      font-size:14px;
    }
    .order-item-meta{
      font-size:13px;
      color:var(--muted);
    }

    .order-footer{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-top:16px;
      padding-top:16px;
      border-top:1px solid #e0e0e0;
    }
    .order-total{
      font-weight:700;
      font-size:18px;
      color:var(--accent);
    }

    .empty-state{
      text-align:center;
      padding:60px 20px;
      color:var(--muted);
    }
    .empty-state-icon{
      font-size:60px;
      margin-bottom:16px;
      opacity:0.3;
    }

    @media (max-width:900px){
      .account-container{
        grid-template-columns:1fr;
      }
      .account-sidebar{
        position:static;
      }
      .info-grid{
        grid-template-columns:1fr;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="container nav">
      <a class="logo" href="/">Natishlux</a>
      <div class="nav-links">
        <a href="shop.html">Shop</a>
        <button class="btn btn-secondary" id="logoutBtn">Logout</button>
      </div>
    </div>
  </header>

  <main>
    <section class="page-header">
      <div class="container">
        <h1>My Account</h1>
        <p id="welcomeText">Welcome back!</p>
      </div>
    </section>

    <div class="account-container">
      <aside class="account-sidebar">
        <h3>Account</h3>
        <ul class="account-nav">
          <li><a href="#" class="active" data-tab="overview">Overview</a></li>
          <li><a href="#" data-tab="orders">My Orders</a></li>
          <li><a href="#" data-tab="profile">Profile Settings</a></li>
        </ul>
      </aside>

      <div class="account-content">
        <!-- Overview Tab -->
        <div id="overviewTab" class="tab-content">
          <div class="section">
            <h2>Account Information</h2>
            <div class="info-grid" id="accountInfo">
              <div class="info-item">
                <div class="info-label">Name</div>
                <div class="info-value" id="userName">-</div>
              </div>
              <div class="info-item">
                <div class="info-label">Email</div>
                <div class="info-value" id="userEmail">-</div>
              </div>
              <div class="info-item">
                <div class="info-label">Phone</div>
                <div class="info-value" id="userPhone">-</div>
              </div>
              <div class="info-item">
                <div class="info-label">Member Since</div>
                <div class="info-value" id="memberSince">-</div>
              </div>
            </div>
          </div>

          <div class="section">
            <h2>Recent Orders</h2>
            <div id="recentOrders">
              <div class="empty-state">
                <div class="empty-state-icon">ðŸ“¦</div>
                <p>No orders yet</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Orders Tab -->
        <div id="ordersTab" class="tab-content" style="display:none">
          <div class="section">
            <h2>Order History</h2>
            <div id="allOrders">
              <div class="empty-state">
                <div class="empty-state-icon">ðŸ“¦</div>
                <p>No orders found</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Profile Tab -->
        <div id="profileTab" class="tab-content" style="display:none">
          <div class="section">
            <h2>Profile Settings</h2>
            <p>Profile editing feature coming soon!</p>
          </div>
        </div>
      </div>
    </div>
  </main>

  <script type="module">
    import { store } from './src/main.js';
    import { logout } from './src/store/slices/userSlice.js';
    import { orderAPI } from './src/services/apiMethods.js';

    // Check authentication
    const state = store.getState();
    if (!state.user.isAuthenticated) {
      window.location.href = 'login.html?return=account.html';
    }

    const user = state.user.currentUser;

    // Display user info
    document.getElementById('welcomeText').textContent = `Welcome back, ${user.firstName}!`;
    document.getElementById('userName').textContent = `${user.firstName} ${user.lastName}`;
    document.getElementById('userEmail').textContent = user.email;
    document.getElementById('userPhone').textContent = user.phone || 'Not provided';
    
    // Format member since date
    if (user.createdAt) {
      const date = new Date(user.createdAt);
      document.getElementById('memberSince').textContent = date.toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'long'
      });
    }

    // Load orders
    async function loadOrders(limit = null) {
      try {
        const params = limit ? { limit } : {};
        const response = await orderAPI.getUserOrders(params);
        const orders = response.data.data;

        return orders;
      } catch (error) {
        console.error('Failed to load orders:', error);
        return [];
      }
    }

    // Render orders
    function renderOrders(orders, containerId) {
      const container = document.getElementById(containerId);
      
      if (!orders || orders.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <div class="empty-state-icon">ðŸ“¦</div>
            <p>No orders found</p>
            <a href="shop.html" class="btn" style="margin-top:16px">Start Shopping</a>
          </div>
        `;
        return;
      }

      container.innerHTML = '';
      
      orders.forEach(order => {
        const orderCard = document.createElement('div');
        orderCard.className = 'order-card';
        
        const statusClass = `status-${order.status}`;
        const orderDate = new Date(order.createdAt).toLocaleDateString('en-US', {
          year: 'numeric',
          month: 'short',
          day: 'numeric'
        });

        orderCard.innerHTML = `
          <div class="order-header">
            <div>
              <div class="order-number">#${order.orderNumber}</div>
              <div class="order-date">${orderDate}</div>
            </div>
            <span class="order-status ${statusClass}">${order.status}</span>
          </div>

          <div class="order-items">
            ${order.items.slice(0, 2).map(item => `
              <div class="order-item">
                <div class="order-item-img">
                  <img src="${item.image}" alt="${item.name}">
                </div>
                <div>
                  <div class="order-item-name">${item.name}</div>
                  <div class="order-item-meta">Qty: ${item.quantity}</div>
                </div>
              </div>
            `).join('')}
            ${order.items.length > 2 ? `<p style="color:var(--muted);font-size:14px;margin:8px 0 0">+${order.items.length - 2} more items</p>` : ''}
          </div>

          <div class="order-footer">
            <div class="order-total">Total: $${order.pricing.total.toFixed(2)}</div>
            <a href="order-confirmation.html?order=${order.orderNumber}" class="btn btn-secondary">View Details</a>
          </div>
        `;
        
        container.appendChild(orderCard);
      });
    }

    // Load recent orders (3 most recent)
    loadOrders(3).then(orders => {
      renderOrders(orders, 'recentOrders');
    });

    // Tab switching
    document.querySelectorAll('[data-tab]').forEach(link => {
      link.addEventListener('click', async (e) => {
        e.preventDefault();
        
        const tab = link.dataset.tab;
        
        // Update active state
        document.querySelectorAll('[data-tab]').forEach(l => l.classList.remove('active'));
        link.classList.add('active');
        
        // Hide all tabs
        document.querySelectorAll('.tab-content').forEach(t => t.style.display = 'none');
        
        // Show selected tab
        if (tab === 'overview') {
          document.getElementById('overviewTab').style.display = 'block';
        } else if (tab === 'orders') {
          document.getElementById('ordersTab').style.display = 'block';
          // Load all orders
          const orders = await loadOrders();
          renderOrders(orders, 'allOrders');
        } else if (tab === 'profile') {
          document.getElementById('profileTab').style.display = 'block';
        }
      });
    });

    // Logout
    document.getElementById('logoutBtn').addEventListener('click', () => {
      if (confirm('Are you sure you want to logout?')) {
        store.dispatch(logout());
        window.location.href = 'index.html';
      }
    });
  </script>
    <script src="./src/utils/mobile-menu.js"></script>

</body>
</html>